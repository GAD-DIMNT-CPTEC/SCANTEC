
** Instrucoes para compilacao e execucao do SCAMTEC_v0.1 **

* Atualmente o SCAMTEC está sendo compilado com o IFORT. Para compila-lo siga os seguintes passos (ao final será gerado o arquivo scamtec.x):

A T E N C A O: O SCAMTEC foi originalmente compilado com o ifort versao 10.1

Ultima atualizacao do README: 10/06/2015

*************************************************************************************************************************
Para instalação no supercomputador TUPA:
*************************************************************************************************************************

1º Logar no TUPA 

------
2º Carregar os modulos do TUPA com o comando:
source /usr/bin/development_config

Escolher a opcao 6

------
3º Escolher um diretorio para a instalação do SCAMTEC
Obs. Pode ser nas areas $HOME/ ou $SUBMIT_HOME/ ou online6/ 

------
4º Baixar a versao do SCAMTEC do repositorio svn (projetos.cptec.inpe.br)
svn export https://svn.cptec.inpe.br/scamtec/branches/lucamarante/SCAMTEC

------
5º Entrar no diretorio do SCAMTEC
cd SCAMTEC

------
6º Para compilar o SCAMTEC execute o script install com o comando:
./install

Escolha a opção 2 para o compilador pgi do TUPA

------
7º Entrar no diretorio core/ onde estão os códigos do SCAMTEC:
cd core/

------
8º Editar o arquivo de configuração de acordo com os experimentos:
gedit scamtec.conf&

É necessário:
-Configurar a data inicial e final, tempo de previsão e tempo de analise e total de previsao
-Configurar o recorte a ser escolhido (global, america sul ou brasil)
-Configurar o experimento referencia e experimentos. 
-Configurar uso de climatologia e precipitacao (normalmente deixar o padrao que ja esta)
-Configurar o diretorio da saida dos dados

------
9º Executar o SCAMTEC (scamtec.conf já está pré-configurado para rodada TestCase)
./scamtec.x


!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
2ª opção para executar o SCAMTEC:
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Para executar o SCAMTEC em um nó auxiliar com qsub é necessário ajustar o script: 
gedit submete_scamtec.qsub&

Ajustar:
-Tempo do walltime
-Diretorios dos logs e exec

Para execução dar os comandos:
module swap tupa2 aux
qsub submete_scamtec.qsub

Para acompanhar o processo:
qstat -u ${USER} @aux20-eth4


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Rodada TestCase
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Para realizar um TesteCase (de apenas 1 dia) com o SCAMTEC segue abaixo os parametros do arquivo scamtec.conf:
Obs.: **Apenas os parametros abaixo devem ser modificados no scamtec.conf.

Starting Time: 2014080100    
Ending Time:   2014080100    
Analisys Time Step:  12      
Forecast Time Step:  12      
Forecast Total Time: 120     
History Time:   48           

Reference model: 1
Reference file: /stornext/online6/assim_dados/lucas.amarante/TesteCase_SCAMTEC/%y4%m2%d2%h2/GPOSNMC%y4%m2%d2%h2%y4%m2%d2%h2P.icn.TQ0299L064.grb 

Number of Experiments: 1

Experiments:
#ModelId Name Diretory File_Name_with_mask
1 EXP01 /stornext/online6/assim_dados/lucas.amarante/TesteCase_SCAMTEC/%y4%m2%d2%h2/GPOSNMC%iy4%im2%id2%ih2%fy4%fm2%fd2%fh2P.fct.TQ0299L064.grb

Output directory: /scratchout/grupos/assim_dados/home/lucas.amarante/saida_scamtec

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


*************************************************************************************************************************
Versao desenvolvimento (para atualização, acréscimo ou deleção dos códigos fonte):
*************************************************************************************************************************

Para o desenvolvimento de novos códigos, implementações de novas métricas ou alterações nos programas fortran (.f90) deve ser feito:

-Logar no eslogin01:
ssh eslogin01 -XC

-Exportar a variavel SCAM_ARCH (localizada no script install) com o comando:
export SCAM_ARCH=cray_pgi

Realizada as mudanças ou adições de programas é necessário dar o comando para compilação:
make

**Caso haja mudanças nos arquivos Makefile, Makefile-deps ou Makefile-objs dar os comandos:
make clean
make


*************************************************************************************************************************
Para instalação em maquina local:
*************************************************************************************************************************

É necessario ter instalado:
-compilador ifort
-package SVN (subversion)
-biblioteca LAPACK

------
1º Entrar em um diretorio de preferencia do usuario para realizar a instalação do SCAMTEC
cd DIRETORIO

------
2º Baixar a versao do SCAMTEC do repositorio svn (projetos.cptec.inpe.br)
svn export https://svn.cptec.inpe.br/scamtec/branches/lucamarante/SCAMTEC_v0.1@139

------
3º Entrar no diretorio do SCAMTEC
cd SCAMTEC_v0.1/

------
4º Para compilar o SCAMTEC execute o script install com o comando:
./install

Escolha a opção 3 para o compilador ifort

------
5º Entrar no diretorio core/ onde estão os códigos do SCAMTEC:
cd core/

------
6º Editar o arquivo de configuração de acordo com os experimentos:
gedit scamtec.conf&

É necessário:
-Configurar a data inicial e final, tempo de previsão e tempo de analise e total de previsao
-Configurar o recorte a ser escolhido (global, america sul ou brasil)
-Configurar o experimento referencia e experimentos. 
-Configurar uso de climatologia e precipitacao (normalmente deixar o padrao que ja esta)
-Configurar o diretorio da saida dos dados

------
7º Executar o SCAMTEC
./scamtec.x


*************************************************************************************************************************
Para instalação do SCAMTEC (para as primeiras versões do sistema):
*************************************************************************************************************************

* Atualmente o SCAMTEC está sendo compilado com o IFORT. Para compila-lo siga os seguintes passos (ao final será gerado o arquivo scamtec.x):

A T E N C A O: O SCAMTEC foi originalmente compilado com o ifort versao 10.1

A. Entre no diretório SCAMTEC_v0.1:
1. export SCAM_ARCH=Darwin_intel
2. cd lib/w3lib
3. make clean & make
4. cd ../mpeu 
5. make clean & make
6. cd ../../core
7. make clean & make

B. Obtencao dos dados para execucao:
1. Um conjunto de testes será disponibilizado no seguinte endereço ftp://ftp1.cptec.inpe.br/jgerd/PUB/SCAMTeC/testcase
2. Configure o arquivo scamtec.conf que encontra-se no diretório SCAMTEC_v0.1/core para apontar para o diretório onde estão os dados de testcase
* execute o scamtec com o comando ./scamtec.x
* serão gerados arquivos txt com o formato estatisticaNOMEEXPERIMENTO.txt
* onde estatistica = vies, rmse, acor
 * NOMEEXPERIMENTO = EXP01, EXP02 ....
 * exemplo viesEXP01.txt
 * Posteriormente será disponibilizado um tutorial para o uso e desenvolvimento do SCAMTEC no endereço: https://projetos.cptec.inpe.br/projects/scamtec/wiki
 

*************************************************************************************************************************
Plot de imagens do SCAMTEC
*************************************************************************************************************************

Para a visualização dos resultados do SCAMTEC:

O script em Matlab /utils/Plota_results_scam.m é utilizado para gerar figuras dos resultados (ACOR, RMS e VIES) dos arquivos *.scam para todas as variaveis de acordo com os parametros de entrada do usuario.



